<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3. Post Hartree–Fock &mdash; moha 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/moha.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Property" href="user_property.html" />
    <link rel="prev" title="2. Hartree-Fock" href="user_hf.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/moha.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">QUICK START:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart_installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart_examples.html">2. Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USER DOCUMENTATION:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_system.html">1. System</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_hf.html">2. Hartree-Fock</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Post Hartree–Fock</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-interaction">3.1. Configuration Interaction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cisd">3.1.1. CISD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#full-ci">3.1.2. Full CI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coupled-cluster">3.2. Coupled-Cluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ccsd">3.2.1. CCSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ccsd-t">3.2.2. CCSD(T)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#perturbation-theory">3.3. Perturbation Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mp2">3.3.1. MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mp3">3.3.2. MP3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_property.html">4. Property</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEVELOPER DOCUMENTATION:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer_sphinx.html">1. Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_api/modules.html">2. API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">moha</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">3. </span>Post Hartree–Fock</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/user_posthf.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="post-hartree-fock">
<h1><span class="section-number">3. </span>Post Hartree–Fock<a class="headerlink" href="#post-hartree-fock" title="Permalink to this headline"></a></h1>
<p>Quantum chemistry is mature enough to have canonical approaches followed by the Hartree–Fock method. Their behavior, successes, and most importantly, their failures are widely known and accepted. With a couple of exceptions which we will not mention, they are:</p>
<ul class="simple">
<li><p>Configuration Interaction(CI)</p></li>
<li><p>Coupled-Cluster(CC)</p></li>
<li><p>Perturbation Theory(PT)</p></li>
</ul>
<div class="section" id="configuration-interaction">
<h2><span class="section-number">3.1. </span>Configuration Interaction<a class="headerlink" href="#configuration-interaction" title="Permalink to this headline"></a></h2>
<p>Configuration interaction approximates wave function by a linear expansion of N–electron basis functions made of a given one–electron basis. With CI wave function and CI basis set, the Schrödinger equation becomes a matrix–eigenvalue equation.</p>
<div class="math notranslate nohighlight">
\[\vert \Psi_{CI}\rangle = \sum_{\lbrace i \rbrace}c_i \vert i\rangle\]</div>
<p>the coefficients <span class="math notranslate nohighlight">\(c_i\)</span> for the configuration state function can be determined by variational principle</p>
<div class="math notranslate nohighlight">
\[\frac{\langle\Psi_{CI}\vert H\vert \Psi_{CI}\rangle}{\langle\Psi_{CI}\vert \Psi_{CI}\rangle}\geq E_0\]</div>
<p>approach the ground state energy by minimizing</p>
<div class="math notranslate nohighlight">
\[min_{\vert\Psi_{CI}\rangle}(\langle\Psi_{CI}\vert H \vert \Psi_{CI}\rangle-\lambda\langle\Psi_{CI}\vert\Psi_{CI}\rangle)\]</div>
<p>which equivalent to a set of eigenvalue equation</p>
<div class="math notranslate nohighlight">
\[E_{CI} = min_{\Psi_{CI}} \frac{\langle \Psi_{CI}\vert\hat{H}\vert\Psi_{CI}\rangle}{\langle\Psi_{CI} \vert \Psi_{CI} \rangle}HC = E_{CI} C\]</div>
<p>where H is the Hamiltonian Matrix with elements</p>
<div class="math notranslate nohighlight">
\[H_{ij} = \langle i\vert\hat{H}\vert j\rangle\]</div>
<p>Without constraints, the configuration interaction wave function contains all Slater determinants generated by distributing n electrons among m spin orbitals, which is called Full CI method. It gives an exact result in a given limited AO basis. Unfortunately, the number of Slater determinants included in full CI method increases very steeply.</p>
<div class="math notranslate nohighlight">
\[N_{det} = \binom{m}{n}\]</div>
<p>therefore full CI method is not applicable in large systems, usually used for benchmarking of minimal system in development of new methods.</p>
<p>In practices, we truncated the CI space by excitation order to save computational time. CI with singly and doubly excited determinants methods(CISD) are implemented in many standard packages.</p>
<div class="math notranslate nohighlight">
\[\vert\Psi_{FCI}\rangle = c_0 \vert\Phi_0\rangle
+ \mathop{\sum_{\lbrace i \rbrace}}_{\lbrace a \rbrace} c_i^a\vert\Phi_i^a\rangle
+ \mathop{\sum_{\lbrace i,j \rbrace}}_{\lbrace a,b \rbrace} c_{ij}^{ab}\vert\Phi_{ij}^{ab}\rangle
+ \dots\]</div>
<p>However, since in the truncated CI higher excitations are forbidden, hence the model is not size-extensive. Also in large systems, high–order disconnected excitations dominate. Truncated CI therefore works best for small systems, and important for small multi–configurational systems.</p>
<div class="section" id="cisd">
<h3><span class="section-number">3.1.1. </span>CISD<a class="headerlink" href="#cisd" title="Permalink to this headline"></a></h3>
<p>In practice, we truncated the CI space by excitation order to save computational time. Configuration interaction with singly and doubly excited determinants methods(CISD) are implemented in many standard packages.</p>
<div class="math notranslate nohighlight">
\[\vert\Psi_{CISD}\rangle = c_0 \vert\Phi_0\rangle
+ \mathop{\sum_{\lbrace i \rbrace}}_{\lbrace a \rbrace} c_i^a \vert\Phi_i^a\rangle
+ \mathop{\sum_{\lbrace i,j \rbrace}}_{\lbrace a,b \rbrace} c_{ij}^{ab} \vert\Phi_{ij}^{ab}\rangle\]</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">/data/examples/ci/cisd.py</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">cisolver</span> <span class="o">=</span> <span class="n">CISDSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">ci_results</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="full-ci">
<h3><span class="section-number">3.1.2. </span>Full CI<a class="headerlink" href="#full-ci" title="Permalink to this headline"></a></h3>
<p>The full CI method assumes that all electrons of a given system are correlated among all orbitals. Hence it provides numerically exact solutions (within the infinitely flexible complete basis set) to the electronic time-independent, non-relativistic Schrödinger equation.</p>
<div class="math notranslate nohighlight">
\[\vert \Psi_{FCI} \rangle = c_0 \vert \Phi_0\rangle
+ \mathop{\sum_{\lbrace i \rbrace}}_{\lbrace a \rbrace} c_i^a \vert\Phi_i^a\rangle
+ \mathop{\sum_{\lbrace i,j \rbrace}}_{\lbrace a,b \rbrace} c_{ij}^{ab} \vert\Phi_{ij}^{ab}\rangle
+ \dots\]</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">/data/examples/ci/fci.py</span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">cisolver</span> <span class="o">=</span> <span class="n">FullCISolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">ci_results</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coupled-cluster">
<h2><span class="section-number">3.2. </span>Coupled-Cluster<a class="headerlink" href="#coupled-cluster" title="Permalink to this headline"></a></h2>
<p>Coupled cluster methods are among the most accurate electronic structure methods available today. Its wave function ansatz is usually written in exponential form:</p>
<div class="math notranslate nohighlight">
\[\vert\Psi\rangle = e^{\hat{T}} \vert\Phi_0\rangle\]</div>
<p>Where the cluster operator <span class="math notranslate nohighlight">\(\hat{T}\)</span> is defined as the sum of <span class="math notranslate nohighlight">\(\hat{T}_{i}\)</span> generates all possible determinants having the i-th excitations from the reference.</p>
<div class="math notranslate nohighlight">
\[\hat{T} = \sum_{i=1}^{N} \hat{T}_{i}\]</div>
<p>the first few component of cluster operator are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{T}_1 &amp;= \mathop{\sum_{i\in occ}}_{\alpha \in virt} t_i^{\alpha} a_{\alpha}^{\dagger} a_{i}\\
\hat{T}_2 &amp;= \frac{1}{(2!)^2}\mathop{\sum_{ij\in occ}}_{\alpha \beta \in virt}
t_{ij}^{\alpha\beta}a_{\alpha}^{\dagger} a_{\beta}^{\dagger} a_{j}a_{i}\end{split}\]</div>
<p>apply a similarity-transformation, multiplying the CC Schrödinger equation in the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{H} e^{\hat{T}} \vert\Phi_{0} \rangle &amp;= E e^{\hat{T}} \vert\Phi_{0} \rangle \\
e^{\hat{-T}}\hat{H} e^{\hat{T}} \vert\Phi_{0} \rangle &amp;= e^{\hat{-T}}E e^{\hat{T}} \vert\Phi_{0} \rangle \\
e^{\hat{-T}}\hat{H} e^{\hat{T}} \vert\Phi_{0} \rangle &amp;= E \vert\Phi_{0} \rangle \\\end{split}\]</div>
<p>the amplitudes should be optimized to determine the CC wave function. Unlike Hartree–Fock or CI wave function is optimized by variational principle, CC wave function is optimized by projecting.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle \Phi_0 \vert\hat{H} e^{\hat{T}} \vert\Phi_{0} \rangle &amp;= E\\
\langle \Phi_{ij\dots}^{ab\dots}\vert e^{\hat{-T}}\hat{H} e^{\hat{T}} \vert\Psi_{0} \rangle &amp;= 0 \\\end{split}\]</div>
<p>by solving the nonlinear equations, the CC energy and amplitudes are determined.</p>
<p>The CC hierarchy represents the most successful wave–function quantum chemistry. It is reasonable to assume that lower-order excitations are more important than higher-order ones. The CCSD wave function contains contributions from all FullCI determinants, generated by connected and disconnected excitations, hence CCSD method is also size–extensive. CCSD and its triples correction CCSD(T) methods are the gold standard of quantum chemistry for its high accuracy and reliability.</p>
<p>Although CC are among the most successful quantum chemistry methods, generalizing CC ansatz to multi–configurational reference states is difficult. Therefore CC method is hard for system with strong correlation.</p>
<div class="section" id="ccsd">
<h3><span class="section-number">3.2.1. </span>CCSD<a class="headerlink" href="#ccsd" title="Permalink to this headline"></a></h3>
<p>To implement the  CCSD method, we should follow the procedure:</p>
<ul class="simple">
<li><p>Preparing the Spin-Orbital Basis Integrals</p></li>
<li><p>Build the Initial-Guess Cluster Amplitudes</p></li>
</ul>
<p>For Hartree-Fock reference determinants, the most common initial guess for the cluster amplitudes are the Moller-Plesset first-order perturbed wave function:</p>
<div class="math notranslate nohighlight">
\[t_i^a = 0\]</div>
<div class="math notranslate nohighlight">
\[t_{ij}^{ab} = \frac{\langle ij \vert\vert ab \rangle}{\epsilon_i + \epsilon_j - \epsilon_a - \epsilon_b}\]</div>
<ul class="simple">
<li><p>Calculate the CC Intermediates</p></li>
</ul>
<p>Use the spin-orbital Eqs. 3-13 from Stanton’s paper to build the two-index (F)
and four-index (W) intermediates, as well as the effective doubles (labelled
with the Greek letter tau).</p>
<ul class="simple">
<li><p>Compute the Updated Cluster Amplitudes</p></li>
</ul>
<p>Use Eqs. 1 and 2 from Stanton’s paper to compute the updated T1 and T2 cluster amplitudes.</p>
<ul class="simple">
<li><p>Check for Convergence and Iterate Calculate the current CC correlation energy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[E_{\rm CC} = \sum_{ia} f_{ia} t_i^a + \frac{1}{4} \sum_{ijab} \langle
ij||ab\rangle t_{ij}^{ab} + \frac{1}{2} \sum_{ijab} \langle ij||ab\rangle t_i^a
t_j^b\]</div>
<p>Compare energies and cluster amplitudes between iterations to check for convergence to some specified cutoff. If convergence is reached, you’re done; if not, return to third step and continue.</p>
<p>To run a CCSD calculation in MoHa, the example is below:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">/data/examples/cc/ccsd.py</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">ccsolver</span> <span class="o">=</span> <span class="n">CCSDSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">cc_results</span> <span class="o">=</span> <span class="n">ccsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ccsd-t">
<h3><span class="section-number">3.2.2. </span>CCSD(T)<a class="headerlink" href="#ccsd-t" title="Permalink to this headline"></a></h3>
<p>To find the perturbative triples correction, the disconnected and connected T3 have to be calculated. The disconnected is found as:</p>
<div class="math notranslate nohighlight">
\[D^{abc}_{ijk}t^{abc}_{ijk,disconnected}=P(i/jk)P(a/bc)t^{a}_{i}\langle jk \vert\vert bc\rangle\]</div>
<p>And the connected is found as:</p>
<div class="math notranslate nohighlight">
\[D_{ijk}^{abc}t_{ijk,\mathrm{connected}}^{abc}=P\left(i/jk\right)P\left(a/bc\right)\left[\sum_{e}^{virt}t_{jk}^{ae}\left\langle ei\left|\right|bc\right\rangle -\sum_{m}^{occ}t_{im}^{bc}\left\langle ma\left|\right|jk\right\rangle \right]\]</div>
<p>In the above equations the following definitions is used:</p>
<div class="math notranslate nohighlight">
\[D_{ijk}^{abc}=f_{ii}+f_{jj}+f_{kk}-f_{aa}-f_{bb}-f_{cc}\]</div>
<div class="math notranslate nohighlight">
\[P\left(i/jk\right)f\left(i,j,k\right)=f\left(i,j,k\right)-f\left(j,i,k\right)-f\left(k,j,i\right)\]</div>
<p>The energy correction can now be found as:</p>
<div class="math notranslate nohighlight">
\[E_{\mathrm{\left(T\right)}}=\frac{1}{36}\sum_{i,j,k,a,b,c}^{occ,occ,occ,virt,virt,virt}t_{ijk,\mathrm{connected}}^{abc}D_{ijk}^{abc}\left(t_{ijk,\mathrm{connected}}^{abc}+t_{ijk,\mathrm{disconnected}}^{abc}\right)\]</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">/data/examples/cc/ccsd_t.py</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">ccsolver</span> <span class="o">=</span> <span class="n">CCSD_TSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">cc_results</span> <span class="o">=</span> <span class="n">ccsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="perturbation-theory">
<h2><span class="section-number">3.3. </span>Perturbation Theory<a class="headerlink" href="#perturbation-theory" title="Permalink to this headline"></a></h2>
<p>For perturbation theory, we divide the Hamiltonian into zero–order operator <span class="math notranslate nohighlight">\(\hat{H}_0 and perturbaing operator :math:\)</span>lambdahat{V}`. Specifically in M{o}ller–Plesset theory, we use the Fock operator as the zero–order operator and the Hartree–Fock state as the zero–order state:</p>
<div class="math notranslate nohighlight">
\[\hat{H}_0 = \hat{F};
\quad \hat{V} = \hat{H} - \hat{F}\]</div>
<p>the unperturbed Schr&quot;{o}dinger equation:</p>
<div class="math notranslate nohighlight">
\[\quad \hat{F}|\Psi_{HF}\rangle = \sum_{i}\varepsilon_i \vert\Psi_{HF}\rangle;\]</div>
<p>the time-independent related Schr&quot;{o}dinger equation:</p>
<div class="math notranslate nohighlight">
\[(\hat{F} + \lambda \hat{V})|\Psi_n \rangle = E_n \vert\Psi_n \rangle\]</div>
<p>we apply Taylor series to expands the energies and states in eqn ref{eq:mp3} of the parameter $lambda$</p>
<div class="math notranslate nohighlight">
\[E_n = E_n^{(0)} + \lambda E_n^{(1)} + \lambda^2 E_n^{(2)} + \dots\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\vert\Psi_{n}\rangle = \vert\Psi_{n}^{(0)} \rangle
+ \lambda \vert\Psi_{n}^{(0)} \rangle + \lambda^2 \vert\Psi_{n}^{(2)} \rangle + \dots\]</div>
<p>the <span class="math notranslate nohighlight">\(E_n^{(k)}\)</span> and <span class="math notranslate nohighlight">\(\Psi_n^{(k)}\)</span> are the corresponding derivatives</p>
<div class="math notranslate nohighlight">
\[E_n^{(k)} = \frac{1}{k!} \frac{\partial^k E_n}{\partial \lambda^k}\]</div>
<div class="math notranslate nohighlight">
\[\Psi_n^{(k)} = \frac{1}{k!} \frac{\partial^k \Psi_n}{\partial \lambda^k}\]</div>
<p>substitute of these expand series into the time-independent Schr&quot;{o}dinger equation</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\hat{F} + \lambda \hat{V})\vert\Psi_n^{(0)} + \lambda \vert\Psi_n^{(1)} + \lambda^2 \vert\Psi_n^{(2)} + \dots\rangle&amp;= \\
(E_n^{(0)} + \lambda E_n^{(1)} + \lambda^2 E_n^{(2)} +\dots) \vert\Psi_n^{(0)} + \lambda \vert\Psi_n^{(1)} + \lambda^2 \vert\Psi_n^{(2)} + \dots\rangle\end{split}\]</div>
<p>we expand both side of the equation, put the terms involving equate powers of <span class="math notranslate nohighlight">\(\lambda\)</span> and generate a set
of equations.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{F}|\Psi_n^{(0)}\rangle
&amp;= E_n^{(0)}|\Psi_n^{(0)}\rangle \\
\hat{F}|\Psi_n^{1}\rangle +\hat{V}|\Psi_n^{(0)}\rangle
&amp;= E_n^{(0)}|\Psi_n^{(1)}\rangle + E_n^{(1)}|\Psi_n^{(0)}\rangle\\
\hat{F}|\Psi_n^{2}\rangle +\hat{V}|\Psi_n^{(1)}\rangle
&amp;= E_n^{(0)}|\Psi_n^{(2)}\rangle + E_n^{(1)}|\Psi_n^{(1)}\rangle         + E_n^{(2)}|\Psi_n^{(0)}\rangle\\
&amp;\dots\end{split}\]</div>
<p>as the solution of zeroth–order equation is known, one expects, Möller–Plesset theory approaches are performed on top of previous result. Therefore we can determine the various nth–order corrections.</p>
<p>Given a reasonably accurate Hartree–Fock reference, we may improve on it by Möller–Plesset perturbation theory. As a non-iterative way to calculate electron correlation energy, The MP2 energy represents a highly successful approximation at a fraction of the cost compare with other post–Hartree–Fock methods.</p>
<p>Unfortunately in a sufficiently large system, the M{o}ller–Plesset method often diverges. Higher-order corrections may be calculated, but convergence is often poor.</p>
<div class="section" id="mp2">
<h3><span class="section-number">3.3.1. </span>MP2<a class="headerlink" href="#mp2" title="Permalink to this headline"></a></h3>
<p>Moller-Plesset Second Order Perturbation theory (MP2) is a non-iterative way to calculate electron correlation energy. The expression for it’s energy contribution can be written as:</p>
<div class="math notranslate nohighlight">
\[E_{\rm MP2} = \sum_{ij} \sum_{ab} \frac{(ia|jb) \left[ 2 (ia|jb) -
(ib|ja) \right]}{\epsilon_i + \epsilon_j - \epsilon_a - \epsilon_b}\]</div>
<p>where the two electron integral are molecular integral and should be transform from atomic orbtial to molecular orbital basis.</p>
<div class="math notranslate nohighlight">
\[(pq|rs) = \sum_\mu C_\mu^p \left[ \sum_\nu C_\nu^q \left[ \sum_\lambda
C_\lambda^r \left[ \sum_\sigma C_\sigma^s (\mu \nu|\lambda \sigma) \right]
\right] \right]\]</div>
<p>To run a MP2 calculation in MoHa, the example is below:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">/data/examples/pt/mp2.py</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">ptsolver</span> <span class="o">=</span> <span class="n">MP2Solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">pt_results</span> <span class="o">=</span> <span class="n">ptsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mp3">
<h3><span class="section-number">3.3.2. </span>MP3<a class="headerlink" href="#mp3" title="Permalink to this headline"></a></h3>
<p>The third order Møller-Plesset correction to the energy is given as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}E_{MP3}&amp;=\frac{1}{8}\sum_{abcdrs}\frac{\left\langle ab\left|\right|rs\right\rangle \left\langle cd\left|\right|ab\right\rangle \left\langle rs\left|\right|cd\right\rangle }{\left(\epsilon_{a}+\epsilon_{b}-\epsilon_{r}-\epsilon_{s}\right)\left(\epsilon_{c}+\epsilon_{d}-\epsilon_{r}-\epsilon_{s}\right)}\\
&amp;+\frac{1}{8}\sum_{abrstu}\frac{\left\langle ab\left|\right|rs\right\rangle \left\langle rs\left|\right|tu\right\rangle \left\langle tu\left|\right|ab\right\rangle }{\left(\epsilon_{a}+\epsilon_{b}-\epsilon_{r}-\epsilon_{s}\right)\left(\epsilon_{a}+\epsilon_{b}-\epsilon_{t}-\epsilon_{u}\right)}\\
&amp;+\sum_{abcrst}\frac{\left\langle ab\left|\right|rs\right\rangle \left\langle cs\left|\right|tb\right\rangle \left\langle rt\left|\right|ac\right\rangle }{\left(\epsilon_{a}+\epsilon_{b}-\epsilon_{r}-\epsilon_{s}\right)\left(\epsilon_{a}+\epsilon_{c}-\epsilon_{r}-\epsilon_{t}\right)}\end{split}\]</div>
<p>To run a MP2 calculation in MoHa, the example is below:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">/data/examples/pt/mp3.py</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moha</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span><span class="p">,</span><span class="n">orbs</span> <span class="o">=</span> <span class="n">IOSystem</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;../data/water.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;sto-3g.nwchem&#39;</span><span class="p">)</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">ChemicalHamiltonian</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">orbs</span><span class="p">)</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="n">HFWaveFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>

<span class="n">scfsolver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">)</span>
<span class="n">hf_results</span> <span class="o">=</span> <span class="n">scfsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">ptsolver</span> <span class="o">=</span> <span class="n">MP3Solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span><span class="n">wfn</span><span class="p">,</span><span class="n">hf_results</span><span class="p">)</span>
<span class="n">pt_results</span> <span class="o">=</span> <span class="n">ptsolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="user_hf.html" class="btn btn-neutral float-left" title="2. Hartree-Fock" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="user_property.html" class="btn btn-neutral float-right" title="4. Property" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Yilin Zhao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>